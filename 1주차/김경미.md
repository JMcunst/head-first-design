# 디자인 패턴의 세계로 떠나기

## 상황 및 문제

### 상황
오리를 날게 하는 기능을 추가해야 하는 상황

 &nbsp; 

 <img src="https://github.com/user-attachments/assets/eff93a49-4b7e-4ed8-97b9-8e3d8123a93e" style="width:400px; height:300px;"/>

### 해결
슈퍼클래스 `Duck`에 `fly()` 메소드를 추가

 &nbsp; 

### 문제
몇몇 서브클래스만 날아야 하는데, 전체 오리가 날게되었다. (예 : 고무오리, 가짜오리도 날게 되어버림)

&nbsp; 

## 슈퍼클래스 `Duck`의 행동을 상속할 때 단점

1. 서브클래스에서 코드가 중복된다.
2. 실행 시에 특징을 바꾸기 힘들다.
3. 모든 오리의 행동을 알기 힘들다.
4. 코드를 변경했을 때 다른 오리들에게 원치 않은 영향을 끼칠 수 있다.

 &nbsp; 

상속을 계속 활용한다면 규격이 바뀔 때마다 프로그램에 추가했던 `Duck`의 서브클래스 `fly()`와 `quack()` 메소드를 일일이 살펴보고 상황에 따라 오버라이드 해야하는 불편함이 있다.
 
 &nbsp; 

## 개선

### 디자인 원칙 1
_**애플리케이션에서 달라지는 부분을 찾아내고, 달라지지 않는 부분과 분리한다.**_

달라지는 부분을 찾아서 나머지 코드에 영향을 주지 않도록 '**캡슐화**' 한다.   
그러면 코드를 변경하는 과정에서 의도치 않게 발생하는 일을 줄이면서 시스템의 유연성을 향상시킬 수 있다.

 <img src="https://github.com/user-attachments/assets/5fddff2b-0061-4702-bd8e-a84b8815d195" style="width:400px; height:300px;"/>


`Duck` 클래스는 그대로 두고, `fly()`와 `quack()`을 `Duck` 클래스로부터 끄집어내서 각 행동을 나타낼 클래스 집합을 만든다.   

(오리마다 소리가 다르기 때문에 quack()메소드도 꺼낸다)

 &nbsp; 

### 디자인 원칙 2
_**구현보다는 인터페이스에 맞춰서 프로그래밍한다.**_

`fly()` 메소드는 `FlyBehavior` 인터페이스로 `quack()` 메소드는 `QuackBehavior` 인터페이스로 구현한다.

 <img src="https://github.com/user-attachments/assets/adf303d1-0e8d-43d4-9621-753aa1f4b561" style="width:400px; height:300px;"/>

예를 들면 `Flybehavior` 인터페이스를 구현하는 클래스인 `FlyWithWings`(날 수 있는 행동을 하는 클래스)와 `FlyNoWay`(날 수 없는 행동을 하는 클래스)로 구현할 수 있다.

`Duck`의 행동은 `FlyWithWings`와 `FlyNoWay`처럼 별도의 클래스 안에 들어있다. 그러면 `Duck` 클래스에서는 그 행동을 구체적으로 구현할 필요가 없다.

 &nbsp; 

#### 인터페이스 대신 추상 슈퍼클래스를 사용해도 될까?
자바의 인터페이스를 사용하라는 것은 아니다.
핵심은 실제 실행 시에 쓰이는 객체가 코드에 고정되지 않도록 상위 형식(supertype)에 맞춰 프로그래밍해서 다형성을 활용해야 한다는 점이다.

객체를 변수에 대입할 때 상위 형식을 구체적으로 구현한 형식이면 어떤 객체든 넣을 수 있기 때문이다. 그러면 변수를 선언하는 클래스에서 실제 객체의 형식을 몰라도 된다.   

 &nbsp; 

#### 상위 형식에 맞춰서 구현시 장점
1. 다른 형식의 객체에서도 나는 행동과 꽥꽥거리는 행동을 _**재사용**_ 할 수 있다. -> 예) 오리 호출기(오리 소리를 내는 장치)
2. 기존 행동 클래스를 수정하거나 추가할 때 `Duck` 클래스를 건드리지 않고도 가능하다. -> 예) 로켓의 추진력으로 날아가는 행동

 &nbsp; 
### 디자인 원칙 3
_**상속보다는 구성을 활용한다.**_

각 오리에는 `FlyBehavior`와 `QuackBehavior`가 있으며, 각각 나는 행동과 꽥꽥거리는 행동을 위임 받는다. 
이런 식으로 두 클래스를 합치는 것을 '구성(Composition)을 이용한다'라고 부른다.   

 <img src="https://github.com/user-attachments/assets/0d533fa7-2547-45f4-880a-92c9a1a170dc" style="width:400px; height:300px;"/>

 &nbsp; 


## 전략 패턴(Strategy Pattern)
위에서 보았던 내용을 전략 패턴이라고 한다.   
전략 패턴은 알고리즘군을 정의하고 캡슐화해서 각각의 알고리즘군을 수정해서 쓸 수 있게 해준다.   
전략 패턴을 사용하면 클라이언트로부터 알고리즘을 분리해서 독립적으로 변경할 수 있다.